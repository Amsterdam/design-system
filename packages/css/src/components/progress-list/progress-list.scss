/**
 * @license EUPL-1.2+
 * Copyright Gemeente Amsterdam
 */

@use "../../common/breakpoint" as *;
@use "../../common/hyphenation" as *;
@use "../../common/text-rendering" as *;

@mixin reset-ol {
  list-style: none;
  margin-block: 0;
  padding-inline-start: 0;
}

.ams-progress-list {
  @include hyphenation;
  @include text-rendering;
  @include reset-ol;

  list-style: none;
}

// Step

.ams-progress-list__step {
  display: flex;
}

// Indicator

.ams-progress-list__indicator {
  align-items: start;
  display: grid;
  flex: none;
  justify-items: center;
  padding-inline: var(--ams-progress-list-indicator-padding-inline);

  @media screen and (min-width: $ams-breakpoint-medium) {
    padding-inline: var(--ams-progress-list-medium-indicator-padding-inline);
  }

  .ams-progress-list__step[aria-current] & {
    padding-inline: calc(
      var(--ams-progress-list-indicator-padding-inline) - var(--ams-progress-list-current-marker-border-width)
    );

    @media screen and (min-width: $ams-breakpoint-medium) {
      padding-inline: calc(
        var(--ams-progress-list-medium-indicator-padding-inline) - var(--ams-progress-list-current-marker-border-width)
      );
    }
  }
}

// Marker

.ams-progress-list__marker {
  align-items: center;
  display: flex;
  grid-area: 1 / 1; // Overlaps the marker and connector.
  z-index: 1;

  .ams-progress-list--heading-2 & {
    block-size: calc(
      var(--ams-progress-list-marker-heading-2-font-size) * var(--ams-progress-list-marker-heading-2-line-height)
    );
  }

  .ams-progress-list--heading-3 & {
    block-size: calc(
      var(--ams-progress-list-marker-heading-3-font-size) * var(--ams-progress-list-marker-heading-3-line-height)
    );
  }

  .ams-progress-list--heading-4 & {
    block-size: calc(
      var(--ams-progress-list-marker-heading-4-font-size) * var(--ams-progress-list-marker-heading-4-line-height)
    );
  }
}

.ams-progress-list__marker-shape {
  aspect-ratio: 1;
  background-color: var(--ams-progress-list-marker-background-color);
  border-radius: 50%;
  display: flex;
  justify-content: center;

  /*
  * round() eliminates sub-pixel rendering issues that distort circular markers.
  * Minor degradation in unsupported browsers is visually unnoticeable.
  */
  // stylelint-disable plugin/use-baseline
  .ams-progress-list--heading-2 & {
    block-size: var(--ams-progress-list-shape-heading-2-block-size);
    block-size: round(down, var(--ams-progress-list-shape-heading-2-block-size), 2px);
    inline-size: var(--ams-progress-list-shape-heading-2-inline-size);
    inline-size: round(down, var(--ams-progress-list-shape-heading-2-inline-size), 2px);
  }

  .ams-progress-list--heading-3 & {
    block-size: var(--ams-progress-list-shape-heading-3-block-size);
    block-size: round(down, var(--ams-progress-list-shape-heading-3-block-size), 2px);
    inline-size: var(--ams-progress-list-shape-heading-3-inline-size);
    inline-size: round(down, var(--ams-progress-list-shape-heading-3-inline-size), 2px);
  }

  .ams-progress-list--heading-4 & {
    block-size: var(--ams-progress-list-shape-heading-4-block-size);
    block-size: round(down, var(--ams-progress-list-shape-heading-4-block-size), 2px);
    inline-size: var(--ams-progress-list-shape-heading-4-inline-size);
    inline-size: round(down, var(--ams-progress-list-shape-heading-4-inline-size), 2px);
  }
  // stylelint-enable plugin/use-baseline

  .ams-progress-list__step--completed & {
    background-color: var(--ams-progress-list-completed-marker-background-color);
  }

  .ams-progress-list__step[aria-current] & {
    background-color: var(--ams-progress-list-current-marker-background-color);
    border-color: var(--ams-progress-list-current-marker-border-color);
    border-style: var(--ams-progress-list-current-marker-border-style);
    border-width: var(--ams-progress-list-current-marker-border-width);
    box-shadow: var(--ams-progress-list-current-marker-box-shadow);
  }
}

.ams-progress-list__marker-icon {
  .ams-progress-list--heading-2 & {
    block-size: var(--ams-progress-list-shape-heading-2-inline-size);
  }

  .ams-progress-list--heading-3 & {
    block-size: var(--ams-progress-list-shape-heading-3-inline-size);
  }

  .ams-progress-list--heading-4 & {
    block-size: var(--ams-progress-list-shape-heading-4-inline-size);
  }
}

// Connector

.ams-progress-list__connector {
  align-self: stretch;
  background-color: var(--ams-progress-list-connector-background-color);
  block-size: 100%;
  grid-area: 1 / 1; // Overlaps the marker and connector.
  inline-size: var(--ams-progress-list-connector-inline-size);

  .ams-progress-list--heading-2 & {
    margin-block-start: calc(
      (var(--ams-progress-list-marker-heading-2-line-height) * var(--ams-progress-list-marker-heading-2-font-size)) / 2
    );
  }

  .ams-progress-list--heading-3 & {
    margin-block-start: calc(
      (var(--ams-progress-list-marker-heading-3-line-height) * var(--ams-progress-list-marker-heading-3-font-size)) / 2
    );
  }

  .ams-progress-list--heading-4 & {
    margin-block-start: calc(
      (var(--ams-progress-list-marker-heading-4-line-height) * var(--ams-progress-list-marker-heading-4-font-size)) / 2
    );
  }

  .ams-progress-list__step--completed & {
    background-color: var(--ams-progress-list-completed-connector-background-color);
  }

  .ams-progress-list__step[aria-current] & {
    background-color: var(--ams-progress-list-current-connector-background-color);
  }

  .ams-progress-list__step:last-child & {
    inline-size: 0;
  }
}

// Content

.ams-progress-list__content {
  flex: auto;
  min-inline-size: 0;
}

// Body

.ams-progress-list__body {
  padding-block-start: var(--ams-progress-list-body-padding-block-start);

  .ams-progress-list__step:not(:last-child) & {
    padding-block-end: var(--ams-progress-list-body-padding-block-end);
  }
}
