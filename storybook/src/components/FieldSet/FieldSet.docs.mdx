{/* @license CC0-1.0 */}

import { Canvas, Controls, Markdown, Meta, Primary } from "@storybook/blocks";
import * as FieldSetStories from "./FieldSet.stories.tsx";
import README from "../../../../packages/css/src/components/field-set/README.md?raw";

<Meta of={FieldSetStories} />

<Markdown>{README}</Markdown>

<Primary />

<Controls />

## Examples

### With Description

A Field Set can have a description.
Make sure to connect this description to the Field Set or a specific input,
otherwise this won’t be read by a screen reader.
Add an `aria-describedby` attribute to the Field Set
and provide the `id` of the describing element as its value.

<Canvas of={FieldSetStories.WithDescription} />

### With Not Required Label

A Field Set can indicate whether all of the inputs it contains are <em>not</em> required.
Make sure to <em>not</em> add a `required` or `aria-required="true"` attribute to <em>any</em> form element in this Field Set.
Also never set either the `aria-required` attribute on a field set that is not of the `role="radiogroup"` (see: [Radio Group](#radio-group)).

<Canvas of={FieldSetStories.WithNotRequiredLabel} />

### With Error

A Field Set can indicate whether any of the inputs it contains has a validation error.
Use Error Message to describe the error.
Make sure to connect the error message to the correct input in the Field Set,
otherwise it won’t be read by a screen reader.
Add an `aria-describedby` attribute to the input and provide the `id` of Error Message as its value.

<Canvas of={FieldSetStories.WithError} />

### Radio group

Use a Field Set to group radio buttons.
When grouping radio inputs, use `role="radiogroup"` on Field Set to have this grouping explicitly announced as a radio group (the default role is `group`).
Using `role="radiogroup"` also allows you to use `aria-required` on Field Set, which isn’t allowed for role `group`.
Always also set `aria-required` on the individual radio buttons though, to make sure it’s read by screen readers.

<Canvas of={FieldSetStories.RadioGroup} />

### Radio Group With Not Required Label

A Field Set with a radio button group can also indicate whether all of the radio inputs it contains are <em>not</em> required.
Make sure to <em>not</em> add the `aria-required="true"` attribute to the Field Set and <em>any</em> input element in this Field Set.

<Canvas of={FieldSetStories.RadioGroupWithNotRequiredLabel} />

### Radio Group With Error

A Field Set with a radio button group can also have a validation error.
In this case, connect the error message to the Field Set instead of an input.
Add an `aria-describedby` attribute to the Field Set and provide the `id` of Error Message as its value.

<Canvas of={FieldSetStories.RadioGroupWithError} />

### Checkbox Group

Use a Field Set to group checkboxes.

Please note: [NVDA has a bug](https://github.com/nvaccess/nvda/issues/12718) which causes it to
not report a description connected to a Field Set when it contains checkboxes.

For this reason, we add the description text to the label.
Screen reader users will no longer be able to skip the description,
but we think that is preferable to missing the description entirely.
Add an `id` to the Field Set and the description, and add both to the `aria-labelledby` attribute of Field Set, like so:

```jsx
<Fieldset
  aria-labelledby="fieldset description"
  id="fieldset"
  legend="Label"
>
  <Paragraph id="description">Description</Paragraph>
  ...
</FieldSet>
```

The order of the `id`s is the order in which they are read by screen readers.

<Canvas of={FieldSetStories.CheckboxGroup} />

Note that you should not make a Field Set containing inputs of `type="checkbox"` required.

### Checkbox Group With Error

Because of [the NVDA bug mentioned earlier](https://github.com/nvaccess/nvda/issues/12718),
we add the Error Message text to the label as well.
Add an `id` to the Field Set and the Error Message, and add both to the `aria-labelledby` attribute of Field Set, like so:

```jsx
<Fieldset
  aria-labelledby="fieldset description"
  id="fieldset"
  legend="Label"
>
  <Paragraph id="description">Description</Paragraph>
  ...
</FieldSet>
```

The order of the `id`s is the order in which they are read by screen readers.

<Canvas of={FieldSetStories.CheckboxGroupWithError} />
