import { Meta } from "@storybook/blocks";
import { IcoFavicon, PngIconAppleTouch, PngIconsWebApp, SvgIconDefault } from "./components/AppIcons";

<Meta title="Docs/Assets/Favicon & App Icons" />

# Favicon & App Icons

Examples of all the assets needed to publish a web app with the proper browser favicon and app names and icons. This set should cover all the combinations of common operating systems (Android, iOS, macOS, Windows) and browsers (Chrome, Safari, Edge, Firefox).

## Overview & examples

### Default SVG Icon

<SvgIconDefault />

```html
<link rel="icon" type="image/svg+xml" href="icon.svg" />
```

### Favicon

<IcoFavicon />

```html
<link rel="icon" href="favicon.ico" sizes="16x16 32x32 64x64" />
```

### Apple Touch Icon

<PngIconAppleTouch />

```html
<link rel="apple-touch-icon" href="apple-touch-icon.png" />
```

### Web App Icons

<PngIconsWebApp />

Include `icons` object in `*.webmanifest` (see [Usage](#usage)):

```json
{
  // ...
  "icons": [
    { "src": "/icon-192.png", "type": "image/png", "sizes": "192x192" },
    { "src": "/icon-512.png", "type": "image/png", "sizes": "512x512" }
  ]
  // ...
}
```

Link the Web Manifest in the `<head>`:

```html
<link rel="manifest" href="app.webmanifest" />
```

> Note: only include a Web Manifest if you want the website to be installable as a Progressive Web App (PWA). Browsers [may prompt the user to install the app](https://web.dev/learn/pwa/installation-prompt) on their device if a manifest is found.

## Usage

First, install these assets as they come with the [Amsterdam Design System Assets](https://www.npmjs.com/package/@amsterdam/design-system-assets):

```sh
npm i @amsterdam/design-system-assets
```

Then you can either use the post install script or manually copy and link the assets.

### (A) Automatic script

Use the [`.postinstall.sh`](https://github.com/Amsterdam/design-system/tree/develop/proprietary/assets/.postinstall.sh) script from the root of your new **Vite React**, **Next.js**, legacy React or generic HTML project to automatically link the assets:

If you only want the icons, but not the Web Manifest:

```sh
# Make sure you are in the root directory of your project!
sh node_modules/@amsterdam/design-system-assets/.postinstall.sh
```

Provide a full app name, and optionally a short app name, if you want to generate a Web Manifest as well. Users will may then be prompted to install the app as a PWA:

```sh
# Make sure you are in the root directory of your project!
# The full app name may not be longer than 30 characters and the short name no longer than 12 characters.
sh node_modules/@amsterdam/design-system-assets/.postinstall.sh "Full App Name" "Short Name"
```

> If an `index.html` is found in the root or in a `public` directory the script will also insert the links in the HTML's `<head>` tag. This will not be the case for Next.js applications.

> This script can work for any project that has an `index.html` file in the root or `public` directory.

### (B) Manual configuration

You can manually [symlink (symbolic link)](https://en.wikipedia.org/wiki/Symbolic_link#POSIX_and_Unix-like_operating_systems) and copy the files to the root or a `public` folder next to where the `index.html` is located in your project. An advantage of symlinking is that it tracks changes to the assets when there are package updates.

Symlinking [the entire favicon directory](https://github.com/Amsterdam/design-system/tree/develop/proprietary/assets/favicon) and copying the [Web Manifest](https://github.com/Amsterdam/design-system/tree/develop/proprietary/assets/app.manifest) can be done as follows:

```sh
# `cd` to the directory where you want to make the symlinks.
ln -s node_modules/@amsterdam/design-system-assets/favicon appicons
# Copy the Web Manifest if you want users to be able to and be prompted to install the app as a PWA.
cp node_modules/@amsterdam/design-system-assets/manifest/app.webmanifest app.webmanifest
```

> Note: for the symlink the last argument in above command cannot be a path, but can only be the file or directory name. I.e. you need to be in the directory where you want to make the symbolic link.

> Note that undoing a symlink can be done by simply removing the created file or directory link:
>
> ```sh
> rm -r appicons app.webmanifest
> ```

> Note: not all servers recognize `.webmanifest` extension. See [Using a link element to link to a manifest on W3.org](https://www.w3.org/TR/appmanifest/#using-a-link-element-to-link-to-a-manifest) for more information.

Make sure that the Web Manifest (`*.webmanifest`), stating the app's name and referencing the PNG icons, is also available in the same location if you want to make the app installable as a PWA. Edit the `app.webmanifest` file to include the app's name and the icons you want to use. For example:

```json
{
  "name": "Your Web App's Full Name", // May not be longer than 30 characters.
  "short_name": "Short name", // May not be longer than 12 characters.
  "icons": [
    { "src": "/appicons/icon-192.png", "type": "image/png", "sizes": "192x192" },
    { "src": "/appicons/icon-512.png", "type": "image/png", "sizes": "512x512" }
  ]
}
```

Then link all these assets by placing the following tags in the `<head>`:

```html
<head>
  ...
  <link rel="icon" href="appicons/favicon.ico" size="16x16 32x32 64x64" />
  <link rel="icon" href="appicons/icon.svg" type="image/svg+xml" />
  <link rel="apple-touch-icon" href="appicons/apple-touch-icon.png" />
  <link rel="manifest" href="app.webmanifest" />
  ...
</head>
```

### Submit the changes

The symlinks and copied and edited files can be committed to the repository.

## Further Reading

- [_How to Favicon in 2024: Six files that fit most needs_ by Andrey Sitnik](https://evilmartians.com/chronicles/how-to-favicon-in-2021-six-files-that-fit-most-needs)
- [_Web App Manifest_ on web.dev](https://web.dev/learn/pwa/web-app-manifest)
